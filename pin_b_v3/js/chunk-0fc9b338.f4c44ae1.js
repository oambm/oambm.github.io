(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fc9b338"],{3304:function(e,t,n){"use strict";n("b093")},af5e:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"set-pool-times"},[n("div",{staticClass:"box"},[n("span",[e._v("选择矿池")]),n("div",{staticClass:"select-container"},[n("span",[e._v(e._s(e.selectedPool?e.selectedPool.symbol:""))]),n("span",{on:{click:function(t){e.showOptions=!e.showOptions}}},[e._v("▼")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showOptions,expression:"showOptions"}],staticClass:"options"},e._l(e.poolOptions,(function(t){return n("span",{on:{click:function(n){return e.selectPool(t)}}},[e._v(e._s(t.symbol))])})),0)]),n("span",[e._v("当前倍率")]),n("div",{staticClass:"input-container input-append"},[n("input",{attrs:{type:"number",readonly:""},domProps:{value:e.oldRatio}}),n("span",[e._v("%")])]),n("span",[e._v("设置倍率")]),n("div",{staticClass:"input-container input-append"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newRatio,expression:"newRatio"}],attrs:{type:"number"},domProps:{value:e.newRatio},on:{input:function(t){t.target.composing||(e.newRatio=t.target.value)}}}),n("span",[e._v("%")])]),n("van-button",{on:{click:e.setPoolTimes}},[e._v("确认")])],1)])},o=[],s=(n("99af"),n("d81d"),n("d3b7"),n("5530")),a=(n("e7e5"),n("d399")),i=(n("96cf"),n("1da1")),c=n("2307"),u=n("a981"),l=n("b9cc"),d={data:function(){return{MineV3Example:null,newRatio:"",selectedPool:null,showOptions:!1,poolOptions:[]}},computed:{oldRatio:function(){return this.selectedPool?this.selectedPool.ratio:""}},created:function(){this.$web3&&this.init()},methods:{selectPool:function(e){this.selectedPool=e,this.showOptions=!1},setPoolTimes:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedPool){t.next=4;break}return t.abrupt("return",a["a"].fail("请选择矿池"));case 4:if(e.newRatio.length){t.next=6;break}return t.abrupt("return",a["a"].fail("请输入新的倍率"));case 6:return a["a"].loading({message:"交易中...",forbidClick:!0,duration:0,loadingType:"spinner"}),n=e.MineV3Example.methods.setPoolTimes(e.selectedPool.poolId,e.newRatio.toWei(10)),t.prev=8,t.next=11,n.call({from:e.$address});case 11:n.send({from:e.$address}).on("transactionHash",(function(e){})).on("receipt",(function(t){e.selectedPool=null,e.newRatio="",a["a"].success("设置成功")})).on("error",(function(e){console.error(e),a["a"].fail("交易失败！")})),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](8),console.error(t.t0),a["a"].fail("交易失败！");case 18:case"end":return t.stop()}}),t,null,[[8,14]])})))()},init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new e.$web3.eth.Contract(c.abi,c.address),e.MineV3Example=n,t.next=4,n.methods.poolLength().call();case 4:for(r=t.sent,o=new e.$web3.BatchRequest,s=0;s<r;s++)o.add(n.methods.pools(s).call.request());o.requestManager.sendBatch(o.requests,function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n,r){var o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=6;break}for(o=[],s=0;s<r.length;s++)o.push((r[s].result||r[s]).decode([{type:"address",name:"lpToken"},{type:"uint256",name:"powerTimes"},{type:"address",name:"feeMiner"},{type:"bool",name:"enable"}]));return t.next=5,e.getOptions(o);case 5:e.poolOptions=t.sent.map((function(e,t){return{poolId:t,symbol:e.symbol,ratio:e.powerTimes.fromWei(10)}}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})))()},getOptions:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getTokens(e);case 2:return r=n.sent,n.abrupt("return",new Promise((function(n){for(var o=new t.$web3.BatchRequest,a=0;a<r.length;a++){var i=new t.$web3.eth.Contract(l,r[a].token0),c=new t.$web3.eth.Contract(l,r[a].token1);o.add(i.methods.symbol().call.request()),o.add(c.methods.symbol().call.request())}o.requestManager.sendBatch(o.requests,(function(t,r){if(!t){for(var o=0,a=0;a<r.length;a+=2)e[o]=Object(s["a"])(Object(s["a"])({},e[o]),{},{symbol:"".concat((r[a].result||r[a]).decode(["string"]),"-").concat(r[a+1].result.decode(["string"]),"/LP")}),o++;n(e)}}))})));case 4:case"end":return n.stop()}}),n)})))()},getTokens:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){for(var r=new t.$web3.BatchRequest,o=0;o<e.length;o++){var s=new t.$web3.eth.Contract(u,e[o].lpToken);r.add(s.methods.token0().call.request()),r.add(s.methods.token1().call.request())}r.requestManager.sendBatch(r.requests,(function(e,t){if(!e){for(var r=[],o=0;o<t.length;o+=2)r.push({token0:(t[o].result||t[o]).decode(["address"]),token1:t[o+1].result.decode(["address"])});n(r)}}))})));case 1:case"end":return n.stop()}}),n)})))()}}},p=d,m=p,f=(n("3304"),n("2877")),h=Object(f["a"])(m,r,o,!1,null,"097007ce",null);t["default"]=h.exports},b093:function(e,t,n){}}]);