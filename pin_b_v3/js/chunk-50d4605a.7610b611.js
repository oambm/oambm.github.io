(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50d4605a"],{"17d4":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"set-pool-times"},[n("div",{staticClass:"box"},[n("span",[e._v("选择矿池")]),n("div",{staticClass:"select-container"},[n("span",[e._v(e._s(e.selectedPool?e.selectedPool.symbol:""))]),n("span",{on:{click:function(t){e.showOptions=!e.showOptions}}},[e._v("▼")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showOptions,expression:"showOptions"}],staticClass:"options"},e._l(e.poolOptions,(function(t){return n("span",{on:{click:function(n){return e.selectPool(t)}}},[e._v(e._s(t.symbol))])})),0)]),n("span",[e._v("当前矿池手续费挖矿合约")]),n("div",{staticClass:"input-container"},[n("input",{attrs:{type:"text",readonly:""},domProps:{value:e.oldFeeMiner}})]),n("span",[e._v("设置矿池手续费挖矿合约")]),n("div",{staticClass:"input-container"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newFeeMiner,expression:"newFeeMiner"}],attrs:{type:"text"},domProps:{value:e.newFeeMiner},on:{input:function(t){t.target.composing||(e.newFeeMiner=t.target.value)}}})]),n("van-button",{on:{click:e.setPoolFeeMiner}},[e._v("确认")])],1)])},s=[],o=(n("99af"),n("d81d"),n("d3b7"),n("5530")),a=(n("e7e5"),n("d399")),i=(n("96cf"),n("1da1")),c=n("2307"),u=n("a981"),l=n("b9cc"),d={data:function(){return{MineV3Example:null,newFeeMiner:"",selectedPool:null,showOptions:!1,poolOptions:[]}},computed:{oldFeeMiner:function(){return this.selectedPool?this.selectedPool.feeMiner:""}},created:function(){this.$web3&&this.init()},methods:{selectPool:function(e){this.selectedPool=e,this.showOptions=!1},setPoolFeeMiner:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedPool){t.next=4;break}return t.abrupt("return",a["a"].fail("请选择矿池"));case 4:if(e.newFeeMiner.length){t.next=8;break}return t.abrupt("return",a["a"].fail("请输入新的矿池手续费挖矿合约"));case 8:if(e.$web3.utils.isAddress(e.newFeeMiner)){t.next=10;break}return t.abrupt("return",a["a"].fail("不是一个地址"));case 10:return a["a"].loading({message:"交易中...",forbidClick:!0,duration:0,loadingType:"spinner"}),n=e.MineV3Example.methods.setPoolFeeMiner(e.selectedPool.poolId,e.newFeeMiner),t.prev=12,t.next=15,n.call({from:e.$address});case 15:n.send({from:e.$address}).on("transactionHash",(function(e){})).on("receipt",(function(t){e.selectedPool=null,e.newFeeMiner="",a["a"].success("设置成功")})).on("error",(function(e){console.error(e),a["a"].fail("交易失败！")})),t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](12),console.error(t.t0),a["a"].fail("交易失败！");case 22:case"end":return t.stop()}}),t,null,[[12,18]])})))()},init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new e.$web3.eth.Contract(c.abi,c.address),e.MineV3Example=n,t.next=4,n.methods.poolLength().call();case 4:for(r=t.sent,s=new e.$web3.BatchRequest,o=0;o<r;o++)s.add(n.methods.pools(o).call.request());s.requestManager.sendBatch(s.requests,function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n,r){var s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=6;break}for(s=[],o=0;o<r.length;o++)s.push((r[o].result||r[o]).decode([{type:"address",name:"lpToken"},{type:"uint256",name:"powerTimes"},{type:"address",name:"feeMiner"},{type:"bool",name:"enable"}]));return t.next=5,e.getOptions(s);case 5:e.poolOptions=t.sent.map((function(e,t){return{poolId:t,symbol:e.symbol,feeMiner:e.feeMiner>0?e.feeMiner:"无"}}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})))()},getOptions:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getTokens(e);case 2:return r=n.sent,n.abrupt("return",new Promise((function(n){for(var s=new t.$web3.BatchRequest,a=0;a<r.length;a++){var i=new t.$web3.eth.Contract(l,r[a].token0),c=new t.$web3.eth.Contract(l,r[a].token1);s.add(i.methods.symbol().call.request()),s.add(c.methods.symbol().call.request())}s.requestManager.sendBatch(s.requests,(function(t,r){if(!t){for(var s=0,a=0;a<r.length;a+=2)e[s]=Object(o["a"])(Object(o["a"])({},e[s]),{},{symbol:"".concat((r[a].result||r[a]).decode(["string"]),"-").concat(r[a+1].result.decode(["string"]),"/LP")}),s++;n(e)}}))})));case 4:case"end":return n.stop()}}),n)})))()},getTokens:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){for(var r=new t.$web3.BatchRequest,s=0;s<e.length;s++){var o=new t.$web3.eth.Contract(u,e[s].lpToken);r.add(o.methods.token0().call.request()),r.add(o.methods.token1().call.request())}r.requestManager.sendBatch(r.requests,(function(e,t){if(!e){for(var r=[],s=0;s<t.length;s+=2)r.push({token0:(t[s].result||t[s]).decode(["address"]),token1:t[s+1].result.decode(["address"])});n(r)}}))})));case 1:case"end":return n.stop()}}),n)})))()}}},p=d,f=p,h=(n("c530"),n("2877")),w=Object(h["a"])(f,r,s,!1,null,"0cb17b54",null);t["default"]=w.exports},"39f6":function(e,t,n){},c530:function(e,t,n){"use strict";n("39f6")}}]);